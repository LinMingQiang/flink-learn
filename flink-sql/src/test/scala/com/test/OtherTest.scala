package com.test

import com.flink.common.util.StringUtils

import scala.collection.mutable.HashSet
import scala.collection.mutable
import scala.collection.mutable.ArrayBuffer
import scala.io.Source

object OtherTest {
  def main(args: Array[String]): Unit = {
    val file = "/Users/eminem/Desktop/test/chicun.txt"
    val srcpa=  "/Users/eminem/Desktop/test/1950x500.jpg"
    Source.fromFile(file).getLines().foreach(l => {
      val Array(h, c) = l.split("x")
      val outp = s"/Users/eminem/Desktop/test/result/$l.jpg"
//      println(h,c,outp)
      OthTest.resizeImage(srcpa, outp, h.trim.toInt, c.trim.toInt, true)
    })



//    addfile // 98
//    del() // 82
//    comp()
    //    val map =
    //      s"""868144032934181
    //         |239DE882-AC2D-4584-A5FF-81F35D0F8C5C
    //         |8CDCCF4E-8725-40D7-89E9-7D484644DD27
    //         |F4B8D0B0-A19F-4093-ADB6-16C4199A988A
    //         |79EDEBF5-370E-43AB-8EA0-9B877036DE48
    //         |91709729-4BE8-4E07-BA6B-231087238483
    //         |107EBA8D-1BD8-4A54-A7AA-97D376303B17
    //         |04810583-0947-4979-9F3D-06E7B48B713A
    //         |AEEC70DC-C3FE-400B-9315-BC0DD4F47C03
    //         |5FDE3682-972F-4930-A609-94C7C29EE062
    //         |446A9AA3-804B-403C-8DB4-47D48FBE957F
    //         |08055755-C7A4-4B68-8A93-3F039295391A
    //         |8C858C57-2455-408C-8F08-01786FADE890
    //         |DF5A402B-9EAC-4E84-9FE2-330C586EBD94
    //         |866440053757721
    //         |D4570227-59F6-44E0-B2CD-9A602D4757A5
    //         |FA27835E-214C-4CC4-9092-29AC5802D13A
    //         |6591B67C-1D69-45E3-A3F1-9D678928B072
    //         |7F9556B0-2E36-44EB-9587-4AA5E56A68EE
    //         |2709B585-A3BF-4167-A22A-C7F29CEC1947
    //         |E94788FA-1DAA-4DE5-9021-3A97770E02FF
    //         |B2EEC0A3-0089-407C-B235-E8474BBFDAC3
    //         |869897036780871
    //         |31CCF3A8-30C8-4C5E-B1A4-D842A69E8B6E
    //         |772075E4-B9E7-4E16-ABAE-FF516B6C5939
    //         |A263F72C-129E-4E77-A91B-5E30E0953309
    //         |865883045018531
    //         |A1D18604-1216-4AA8-9CC6-256B6D0CFB50
    //         |860534052328736
    //         |0BA6ABA4-72F0-45A3-8F81-286012B18445
    //         |4EA00255-3348-4E03-9A38-5FCA5B4DF891
    //         |864492042327134
    //         |D53219CF-67A9-44D6-AACD-00EBBA7515E5
    //         |861102053370872
    //         |CDF1F798-77E9-4302-B032-A3A0D850B57F
    //         |867081045438019
    //         |357250094739711
    //         |1688A73E-7C6D-4B59-AA84-47ED19927781
    //         |354877104133197
    //         |456EEEED-D772-4C97-B6EF-98F5C704D75C
    //         |2AED9D96-5966-473C-8E72-C1C7C3C50F2D
    //         |88F3FEDD-AE35-4B9E-85F0-FC79CB812FDD
    //         |867666037923851
    //         |862733049708608
    //         |CC5C2911-561B-4651-897E-7B31EEDCA89B
    //         |868726049603039/868726049603021
    //         |E99D4FF8-48FA-437B-829F-36B03074383A
    //         |865736039134542
    //         |D2E4D4DE-A4CF-4E4A-8963-C3DD913D8A0C
    //         |D1984F35-032F-4EE8-AA6A-5B3269F79129
    //         |F284B059-D6F1-4FE2-8BAD-7EC30D5FD457
    //         |0CF15421-A99F-4CC1-8F94-E4A3B010727A
    //         |861335052055959
    //         |D5AAC39A-4577-4AEB-BBCC-D6BE7FDA1114
    //         |F6C9FDD5-92F7-4A4A-B918-A0059C817222
    //         |869632050052059
    //         |7BBBC3D4-1F93-4E53-8CAF-9514041FEEF0
    //         |EC90DF80-1EF0-4661-A612-90F454D670BA
    //         |C36234A7-505D-4930-A463-FF2071C3284D
    //         |863463046471997
    //         |866101048583578
    //         |865706049292739
    //         |865563045724136
    //         |869163043312228
    //         |217B1C08-B1C1-4BF6-AB4F-51925D4677AB
    //         |DE8EBD94-B3AB-4D5E-AE01-8F12DD9D8F46
    //         |862495041132977
    //         |296E77B2-5EC7-4581-BC59-B16920230089
    //         |860697041599228
    //         |AD6D6E38-9881-4B59-9066-2E855F8E892F
    //         |865873043755325
    //         |C5971DBE-0306-4A47-B2C4-B0BE0592F752
    //         |868674040008164
    //         |861023048675086
    //         |D0A1593B-4605-44D8-BC42-0C1FD8398643
    //         |2D623E89-5EEC-46C4-A715-39BD11792F5B
    //         |864492048714293
    //         |869755034865575
    //         |B2521D74-5F23-459D-BF5E-7E7E368907DA
    //         |868663030172064
    //         |861616049767438
    //         |865736034100902
    //         |867284042689127
    //         |E2E00DB0-1426-48B2-B777-3290A1B4D6FA
    //         |4F87620B-C68C-4522-8B52-C18D17224C80
    //         |862145045557287
    //         |35A4E567-760B-4B81-B196-8C7EB3434951
    //         |3D28E072-3652-444F-8C2E-C355F6A756BA
    //         |869899045722910
    //         |B515F5B0-15BD-4669-BC17-20AAB93A4A32
    //         |860255040569062
    //         |35 325207 770188 6
    //         |6C1ED797-742D-4DBF-9DA5-338A65986E2D
    //         |869386047185734
    //         |863478051173551
    //         |9461F20C-B48B-4362-9D3A-D945079D3F3D
    //         |867296041478211
    //         |869456032300737
    //         |351922101017937/28
    //         |DABC68B8-B1F2-4575-9C2A-6F8C7C0E1FC7
    //         |869702039394920
    //         |868971042840549""".stripMargin
    //
    //    val srcMap = map
    //      .split("\n")
    //      .map(x => {
    //        val md5 = StringUtils.encryptMd5_32(x.toLowerCase)
    //        md5 -> x
    //      })
    //      .toMap
    //    val f = Source.fromFile(
    //      "/Users/eminem/Library/Containers/com.tencent.xinWeChat/Data/Library/Application Support/com.tencent.xinWeChat/2.0b4.0.9/7fc7274020876532ac632fe94aa78645/Message/MessageTemp/4d1c36475a72a2a5b8acd606225828eb/File/getui.txt")
    //    val getui = f
    //      .getLines()
    //      .map(x => x -> 1).toMap
    //
    //
    //    srcMap.foreach(v => {
    //      val md5S = v._1
    //      if(getui.contains(md5S)) {
    ////        println(">>: ", md5S , v._2)
    //        println(md5S)
    //
    //      } else {
    ////        println("false : " , md5S, v._2)
    //      }
    //    })
    ////
    ////
    ////
  }

  def test(): Unit = {
    val arr = Array(HashSet(1, 2, 3, 4),
      HashSet(3, 5),
      HashSet(2, 7, 1, 2, 3, 5),
      HashSet(8, 9),
      HashSet(5, 6),
      HashSet(9, 10))
    val map = new mutable.HashMap[Int, HashSet[Int]]()
    val hasRead = new mutable.HashMap[Int, Boolean]()
    val result = new ArrayBuffer[HashSet[Int]]
    arr.foreach(set => {
      set.foreach(id => {
        if (map.contains(id)) {
          map.put(id, map(id).++(set))
        } else {
          map.put(id, set)
        }
      })
    })

    arr.foreach(set => {
      set.foreach(id => {
        if (!hasRead.contains(id)) {
          val r = new HashSet[Int]()
          digui(id, map, hasRead, r)
          result.+=(r)
        }
      })
    })
    result.foreach(println)
  }

  def digui(id: Int,
            map: mutable.HashMap[Int, HashSet[Int]],
            hasRead: mutable.HashMap[Int, Boolean],
            result: HashSet[Int]): Unit = {
    if (!hasRead.contains(id)) {
      result.add(id)
      map(id).foreach(guanlianid => {
        if (guanlianid != id) {
          hasRead.put(id, true)
          digui(guanlianid, map, hasRead, result)
        }
      })
    }
  }


  def addfile(): Unit = {
    val files =
      s"""2020-01-12.log
         |2020-01-14.log
         |2020-02-01.log
         |2020-02-03.log
         |2020-02-04.log
         |2020-02-05.log
         |2020-02-10.log
         |2020-02-11.log
         |2020-02-14.log
         |2020-02-15.log
         |2020-02-16.log
         |2020-02-25.log
         |2020-02-26.log
         |2020-02-27.log
         |2020-02-28.log
         |2020-03-01.log
         |2020-03-18.log
         |2020-03-19.log
         |2020-03-21.log
         |2020-03-22.log
         |2020-03-23.log
         |2020-03-27.log
         |2020-03-29.log
         |2020-03-31.log
         |2020-04-01.log
         |2020-04-04.log
         |2020-04-05.log
         |2020-04-10.log
         |2020-04-12.log
         |2020-04-13.log
         |2020-04-20.log
         |2020-04-22.log
         |2020-04-23.log
         |2020-04-24_1.log
         |2020-04-24.log
         |2020-04-25.log
         |2020-04-26_1.log
         |2020-04-26.log
         |2020-04-27.log
         |2020-05-14.log
         |2020-05-15.log
         |2020-05-16.log
         |2020-05-17.log
         |2020-05-18.log
         |2020-05-20.log
         |2020-05-22.log
         |2020-05-24.log
         |2020-05-26.log
         |2020-05-27.log
         |2020-06-23.log
         |2020-06-27.log
         |2020-06-28.log
         |2020-06-29.log
         |2020-07-03.log
         |2020-07-31.log
         |2020-08-01.log
         |2020-08-06.log
         |2020-09-08.log
         |2020-09-09.log
         |2020-09-10_1.log
         |2020-09-12_1.log
         |2020-09-12.log
         |2020-09-13_1.log
         |2020-09-13.log
         |2020-09-14.log
         |2020-09-15.log
         |2020-09-16.log
         |2020-09-17.log
         |2020-09-18.log
         |2020-09-19.log
         |2020-09-23.log
         |2020-10-15.log
         |2020-10-16.log
         |2020-10-17.log
         |2020-10-18.log
         |2020-10-19.log
         |2020-10-20.log
         |2020-11-10.log
         |2020-11-12.log
         |2020-11-13.log
         |2020-11-14.log
         |2020-11-15.log
         |2020-11-16.log
         |2020-12-01.log
         |2020-12-04.log
         |2020-12-05.log
         |2020-12-06.log
         |2020-12-08.log
         |2020-12-09_1.log
         |2020-12-10.log
         |2020-12-14.log
         |2020-12-17.log
         |2020-12-19.log
         |2020-12-20.log
         |2020-12-21.log
         |2020-12-23.log
         |2020-12-24.log
         |2020-12-29.log""".stripMargin
    val c = new ArrayBuffer[String]()
    val s = new ArrayBuffer[String]()
    val tar = new ArrayBuffer[String]()
    var count = 0;
    files.split("\n").foreach(x => {
      count+=1
      val day = x.replaceAll("-", "").replaceAll(".log", "")
      val cat = s"""cat add/output/$x ${day}/click_v2.log > ${day}/click_2.log"""
      val sort = s"""sort -n -k 5 -t : ${day}/click_2.log -o ${day}/click_2.log"""
      val tarr = s"""tar -czvf /data1/marketplus/tmp/outputnew/$day/click_2.log.tar.gz /data1/marketplus/tmp/output/output/$day/click_2.log"""
      val cp = s"""cp /data1/marketplus/tmp/outputnew/$day/click_2.log.tar.gz /data1/marketplus/tmp/output/$day/"""
      val mvold = s"""mv /data1/marketplus/tmp/output/$day/click_2.log.tar.gz /data1/marketplus/tmp/output/$day/click_v2.log.tar.gz"""
      c.+=(cat)
      s.+=(sort)
      tar.+=(mvold)
    })
    tar.foreach(println)
    println(count)
//    c.foreach(println)
//    s.foreach(println)

  }


  def del(): Unit = {
    val d =
      s"""2020-01-08	272230
         |2020-01-09	346552
         |2020-01-10	355639
         |2020-01-11	335672
         |2020-01-13	315673
         |2020-02-02	106609
         |2020-02-06	114530
         |2020-02-07	60058
         |2020-02-12	156832
         |2020-02-13	133000
         |2020-02-29	119882
         |2020-03-02	84878
         |2020-03-20	164699
         |2020-03-24	145280
         |2020-03-25	155742
         |2020-03-26	149134
         |2020-03-28	168460
         |2020-03-30	152181
         |2020-04-02	97630
         |2020-04-03	77701
         |2020-04-06	94214
         |2020-04-07	76141
         |2020-04-08	76264
         |2020-04-09	78918
         |2020-04-11	78533
         |2020-04-14	79395
         |2020-04-15	77532
         |2020-04-16	78068
         |2020-04-17	66949
         |2020-04-21	104226
         |2020-04-22_1	27534
         |2020-04-23_1	78982
         |2020-04-25_1	78053
         |2020-04-28	28055
         |2020-05-13	70124
         |2020-05-19	122743
         |2020-05-21	126338
         |2020-05-23	142326
         |2020-05-25	126173
         |2020-05-28	125926
         |2020-05-29	100510
         |2020-06-24	87093
         |2020-06-25	164845
         |2020-06-26	333312
         |2020-06-30	426946
         |2020-07-01	455152
         |2020-07-02	558692
         |2020-07-04	372832
         |2020-08-02	414711
         |2020-08-03	441280
         |2020-08-04	455951
         |2020-08-05	494808
         |2020-09-10	56015
         |2020-09-11	116202
         |2020-09-20	124581
         |2020-09-21	123289
         |2020-09-22	120787
         |2020-09-07	95773
         |2020-09-11_1	118819
         |2020-10-21	324837
         |2020-11-11	218148
         |2020-11-27	24713
         |2020-11-28	87177
         |2020-11-29	71966
         |2020-11-30	81899
         |2020-12-02	69769
         |2020-12-03	70634
         |2020-12-07	73421
         |2020-12-09	75539
         |2020-12-08_1	31582
         |2020-12-10_1	60294
         |2020-12-11	79862
         |2020-12-12	62904
         |2020-12-13	70965
         |2020-12-15	83190
         |2020-12-16	70061
         |2020-12-18	72128
         |2020-12-22	49703
         |2020-12-25	83937
         |2020-12-26	90929
         |2020-12-27	84048
         |2020-12-28	74008""".stripMargin
  var count = 0;
    d.split("\n").foreach(x => {
      count+=1
      val Array(day, inc) = x.split("	")
      val d = day.replaceAll("-", "")
      val he = s"""head -$inc $d/click_v2.log > $d/click_2.log""".stripMargin
      val tarr = s"""tar -czvf /data1/marketplus/tmp/outputnew/$d/click_2.log.tar.gz /data1/marketplus/tmp/output/output/$d/click_2.log"""
      val cp = s"""cp /data1/marketplus/tmp/outputnew/$d/click_2.log.tar.gz /data1/marketplus/tmp/output/$d/"""
      val mvold = s"""mv /data1/marketplus/tmp/output/$d/click_2.log.tar.gz /data1/marketplus/tmp/output/$d/click_v2.log.tar.gz"""
      println(mvold)
//      println(he)
    }
    )
    println(count)
  }

  def comp(): Unit = {
    val sourc =
      s"""2020-01-08	272230
         |2020-01-09	346552
         |2020-01-10	355639
         |2020-01-11	335672
         |2020-01-12	406364
         |2020-01-13	315673
         |2020-01-14	273942
         |2020-02-01	85519
         |2020-02-02	106609
         |2020-02-03	109412
         |2020-02-04	109783
         |2020-02-05	90761
         |2020-02-06	114530
         |2020-02-07	60058
         |2020-02-10	84680
         |2020-02-11	111628
         |2020-02-12	156832
         |2020-02-13	133000
         |2020-02-14	119465
         |2020-02-15	113861
         |2020-02-16	95212
         |2020-02-25	109744
         |2020-02-26	116483
         |2020-02-27	105489
         |2020-02-28	95107
         |2020-02-29	119882
         |2020-03-01	118548
         |2020-03-02	84878
         |2020-03-18	96817
         |2020-03-19	146853
         |2020-03-20	164699
         |2020-03-21	149065
         |2020-03-22	144804
         |2020-03-23	184437
         |2020-03-24	145280
         |2020-03-25	155742
         |2020-03-26	149134
         |2020-03-27	162500
         |2020-03-28	168460
         |2020-03-29	149909
         |2020-03-30	152181
         |2020-03-31	103982
         |2020-04-01	15172
         |2020-04-02	97630
         |2020-04-03	77701
         |2020-04-04	88224
         |2020-04-05	74593
         |2020-04-06	94214
         |2020-04-07	76141
         |2020-04-08	76264
         |2020-04-09	78918
         |2020-04-10	77988
         |2020-04-11	78533
         |2020-04-12	74282
         |2020-04-13	80670
         |2020-04-14	79395
         |2020-04-15	77532
         |2020-04-16	78068
         |2020-04-17	66949
         |2020-04-20	37424
         |2020-04-21	104226
         |2020-04-22	116694
         |2020-04-23	113844
         |2020-04-24	78304
         |2020-04-25	96597
         |2020-04-26	10076
         |2020-04-22_1	27534
         |2020-04-23_1	78982
         |2020-04-24_1	77227
         |2020-04-25_1	78053
         |2020-04-26_1	69921
         |2020-04-27	76544
         |2020-04-28	28055
         |2020-05-13	70124
         |2020-05-14	129067
         |2020-05-15	122738
         |2020-05-16	111535
         |2020-05-17	129793
         |2020-05-18	132980
         |2020-05-19	122743
         |2020-05-20	126881
         |2020-05-21	126338
         |2020-05-22	128666
         |2020-05-23	142326
         |2020-05-24	123766
         |2020-05-25	126173
         |2020-05-26	127015
         |2020-05-27	128299
         |2020-05-28	125926
         |2020-05-29	100510
         |2020-06-05	0
         |2020-06-06	0
         |2020-06-07	0
         |2020-06-08	0
         |2020-06-09	0
         |2020-06-10	0
         |2020-06-11	0
         |2020-06-12	0
         |2020-06-11	0
         |2020-06-12	0
         |2020-06-13	0
         |2020-06-14	0
         |2020-06-15	0
         |2020-06-16	0
         |2020-06-17	0
         |2020-06-20	0
         |2020-06-21	0
         |2020-06-22	0
         |2020-06-23	7899
         |2020-06-24	87093
         |2020-06-25	164845
         |2020-06-26	333312
         |2020-06-27	388035
         |2020-06-28	428173
         |2020-06-29	356360
         |2020-06-30	426946
         |2020-07-01	455152
         |2020-07-02	558692
         |2020-07-03	599040
         |2020-07-04	372832
         |2020-07-31	148252
         |2020-08-01	425966
         |2020-08-02	414711
         |2020-08-03	441280
         |2020-08-04	455951
         |2020-08-05	494808
         |2020-08-06	181899
         |2020-09-10	56015
         |2020-09-11	116202
         |2020-09-12	122385
         |2020-09-13	129128
         |2020-09-14	121351
         |2020-09-15	120336
         |2020-09-16	124164
         |2020-09-17	128630
         |2020-09-18	121401
         |2020-09-19	120444
         |2020-09-20	124581
         |2020-09-21	123289
         |2020-09-22	120787
         |2020-09-23	63739
         |2020-09-07	95773
         |2020-09-08	92137
         |2020-09-09	119549
         |2020-09-10_1	90231
         |2020-09-11_1	118819
         |2020-09-12_1	113330
         |2020-09-13_1	95900
         |2020-10-15	271384
         |2020-10-16	332233
         |2020-10-17	282636
         |2020-10-18	344475
         |2020-10-19	342139
         |2020-10-20	309731
         |2020-10-21	324837
         |2020-11-10	91373
         |2020-11-11	218148
         |2020-11-12	317465
         |2020-11-13	478490
         |2020-11-14	453422
         |2020-11-15	320202
         |2020-11-16	235386
         |2020-11-27	24713
         |2020-11-28	87177
         |2020-11-29	71966
         |2020-11-30	81899
         |2020-12-01	69530
         |2020-12-02	69769
         |2020-12-03	70634
         |2020-12-04	72871
         |2020-12-05	75205
         |2020-12-06	72841
         |2020-12-07	73421
         |2020-12-08	72650
         |2020-12-09	75539
         |2020-12-10	55583
         |2020-12-08	72650
         |2020-12-08_1	31582
         |2020-12-09_1	74474
         |2020-12-10_1	60294
         |2020-12-11	79862
         |2020-12-12	62904
         |2020-12-13	70965
         |2020-12-14	73265
         |2020-12-15	83190
         |2020-12-16	70061
         |2020-12-17	72333
         |2020-12-18	72128
         |2020-12-19	73279
         |2020-12-20	71495
         |2020-12-21	44909
         |2020-12-22	49703
         |2020-12-23	62411
         |2020-12-24	69531
         |2020-12-25	83937
         |2020-12-26	90929
         |2020-12-27	84048
         |2020-12-28	74008
         |2020-12-29	37904""".stripMargin
    val res =
      s"""272230 20200108/click_2.log
         |346552 20200109/click_2.log
         |355639 20200110/click_2.log
         |335672 20200111/click_2.log
         |406364 20200112/click_2.log
         |315673 20200113/click_2.log
         |273942 20200114/click_2.log
         |85519 20200201/click_2.log
         |106609 20200202/click_2.log
         |109412 20200203/click_2.log
         |109783 20200204/click_2.log
         |90761 20200205/click_2.log
         |114530 20200206/click_2.log
         |60058 20200207/click_2.log
         |84680 20200210/click_2.log
         |111628 20200211/click_2.log
         |156832 20200212/click_2.log
         |133000 20200213/click_2.log
         |119465 20200214/click_2.log
         |113861 20200215/click_2.log
         |95212 20200216/click_2.log
         |109744 20200225/click_2.log
         |116483 20200226/click_2.log
         |105489 20200227/click_2.log
         |95107 20200228/click_2.log
         |119882 20200229/click_2.log
         |118548 20200301/click_2.log
         |84878 20200302/click_2.log
         |96817 20200318/click_2.log
         |146853 20200319/click_2.log
         |164699 20200320/click_2.log
         |149065 20200321/click_2.log
         |144804 20200322/click_2.log
         |184437 20200323/click_2.log
         |145280 20200324/click_2.log
         |155742 20200325/click_2.log
         |149134 20200326/click_2.log
         |162500 20200327/click_2.log
         |168460 20200328/click_2.log
         |149909 20200329/click_2.log
         |152181 20200330/click_2.log
         |103982 20200331/click_2.log
         |15172 20200401/click_2.log
         |97630 20200402/click_2.log
         |77701 20200403/click_2.log
         |88224 20200404/click_2.log
         |74593 20200405/click_2.log
         |94214 20200406/click_2.log
         |76141 20200407/click_2.log
         |76264 20200408/click_2.log
         |78918 20200409/click_2.log
         |77988 20200410/click_2.log
         |78533 20200411/click_2.log
         |74282 20200412/click_2.log
         |80670 20200413/click_2.log
         |79395 20200414/click_2.log
         |77532 20200415/click_2.log
         |78068 20200416/click_2.log
         |66949 20200417/click_2.log
         |37424 20200420/click_2.log
         |104226 20200421/click_2.log
         |27534 20200422_1/click_2.log
         |116694 20200422/click_2.log
         |78982 20200423_1/click_2.log
         |113844 20200423/click_2.log
         |77227 20200424_1/click_2.log
         |78304 20200424/click_2.log
         |78053 20200425_1/click_2.log
         |96597 20200425/click_2.log
         |69921 20200426_1/click_2.log
         |10076 20200426/click_2.log
         |76544 20200427/click_2.log
         |28055 20200428/click_2.log
         |70124 20200513/click_2.log
         |129067 20200514/click_2.log
         |122738 20200515/click_2.log
         |111535 20200516/click_2.log
         |129793 20200517/click_2.log
         |132980 20200518/click_2.log
         |122743 20200519/click_2.log
         |126881 20200520/click_2.log
         |126338 20200521/click_2.log
         |128666 20200522/click_2.log
         |142326 20200523/click_2.log
         |123766 20200524/click_2.log
         |126173 20200525/click_2.log
         |127015 20200526/click_2.log
         |128299 20200527/click_2.log
         |125926 20200528/click_2.log
         |100510 20200529/click_2.log
         |7899 20200623/click_2.log
         |87093 20200624/click_2.log
         |164845 20200625/click_2.log
         |333312 20200626/click_2.log
         |388035 20200627/click_2.log
         |428173 20200628/click_2.log
         |356360 20200629/click_2.log
         |426946 20200630/click_2.log
         |455152 20200701/click_2.log
         |558692 20200702/click_2.log
         |599040 20200703/click_2.log
         |372832 20200704/click_2.log
         |148252 20200731/click_2.log
         |425966 20200801/click_2.log
         |414711 20200802/click_2.log
         |441280 20200803/click_2.log
         |455951 20200804/click_2.log
         |494808 20200805/click_2.log
         |181899 20200806/click_2.log
         |95773 20200907/click_2.log
         |92137 20200908/click_2.log
         |119549 20200909/click_2.log
         |90231 20200910_1/click_2.log
         |56015 20200910/click_2.log
         |118819 20200911_1/click_2.log
         |116202 20200911/click_2.log
         |113330 20200912_1/click_2.log
         |122385 20200912/click_2.log
         |95900 20200913_1/click_2.log
         |129128 20200913/click_2.log
         |121351 20200914/click_2.log
         |120336 20200915/click_2.log
         |124164 20200916/click_2.log
         |128630 20200917/click_2.log
         |121401 20200918/click_2.log
         |120444 20200919/click_2.log
         |124581 20200920/click_2.log
         |123289 20200921/click_2.log
         |120787 20200922/click_2.log
         |63739 20200923/click_2.log
         |271384 20201015/click_2.log
         |332233 20201016/click_2.log
         |282636 20201017/click_2.log
         |344475 20201018/click_2.log
         |342139 20201019/click_2.log
         |309731 20201020/click_2.log
         |324837 20201021/click_2.log
         |91373 20201110/click_2.log
         |218148 20201111/click_2.log
         |317465 20201112/click_2.log
         |478490 20201113/click_2.log
         |453422 20201114/click_2.log
         |320202 20201115/click_2.log
         |235386 20201116/click_2.log
         |24713 20201127/click_2.log
         |87177 20201128/click_2.log
         |71966 20201129/click_2.log
         |81899 20201130/click_2.log
         |69530 20201201/click_2.log
         |69769 20201202/click_2.log
         |70634 20201203/click_2.log
         |72871 20201204/click_2.log
         |75205 20201205/click_2.log
         |72841 20201206/click_2.log
         |73421 20201207/click_2.log
         |31582 20201208_1/click_2.log
         |72650 20201208/click_2.log
         |74474 20201209_1/click_2.log
         |75539 20201209/click_2.log
         |60294 20201210_1/click_2.log
         |55583 20201210/click_2.log
         |79862 20201211/click_2.log
         |62904 20201212/click_2.log
         |70965 20201213/click_2.log
         |73265 20201214/click_2.log
         |83190 20201215/click_2.log
         |70061 20201216/click_2.log
         |72333 20201217/click_2.log
         |72128 20201218/click_2.log
         |73279 20201219/click_2.log
         |71495 20201220/click_2.log
         |44909 20201221/click_2.log
         |49703 20201222/click_2.log
         |62411 20201223/click_2.log
         |69531 20201224/click_2.log
         |83937 20201225/click_2.log
         |90929 20201226/click_2.log
         |84048 20201227/click_2.log
         |74008 20201228/click_2.log
         |37904 20201229/click_2.log""".stripMargin

    val srcMap = sourc.split("\n").map(x => {
      val Array(day, inc) = x.split("	")
      val d = day.replaceAll("-", "")
      d -> inc
    }
    ).toMap

    res.split("\n").foreach(x => {
      val Array(incy, d) = x.split(" ")
      val da  = d.split("/")(0)
      if (srcMap.contains(da)) {
        if((incy.toInt - srcMap(da).toInt) != 0)
        println(da, incy, srcMap(da), (incy.toInt - srcMap(da).toInt))
      } else
        println(">>>>", da, incy)
    }
    )
  }


  def tar(): Unit ={
    val day = ""
    // tar -czvf 20200108/click_v2.log.tar.gz /data1/marketplus/tmp/output/output/20200108/click_v2.log.b
    val tarr = s"""tar -czvf $day/click_v2.log.tar.gz /data1/marketplus/tmp/output/output/$day/click_v2.log.b"""

  }
}